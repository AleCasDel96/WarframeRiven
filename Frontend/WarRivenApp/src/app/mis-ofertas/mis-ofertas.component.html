<div style="max-width: 800px; margin: 2rem auto;">
  <h2>Mis Ofertas</h2>

  <input [(ngModel)]="searchText" placeholder="üîç Buscar por nombre o arma" />

  <table border="1" cellpadding="8" style="width: 100%; margin-top: 1rem;">
    <thead>
      <tr>
        <th (click)="ordenarPor('nombreRiven')" style="cursor: pointer;">Nombre</th>
        <th (click)="ordenarPor('arma')" style="cursor: pointer;">Arma</th>
        <th (click)="ordenarPor('precioVenta')" style="cursor: pointer;">Precio</th>
        <th>Estado</th>
        <th>Acciones</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let o of ofertas 
                  | filterBy: ['nombreRiven', 'arma']: searchText 
                  | orderBy: [ [sortColumn, sortAsc ? 'asc' : 'desc'] ]
                  | paginate: { itemsPerPage: 5, currentPage: p }">

        <td>{{ o.nombreRiven }}</td>
        <td>{{ o.arma }}</td>
        <td>{{ o.precioVenta }}</td>
        <td>
          <span *ngIf="!o.partida && !o.destino" style="color: red;">‚ùå Ninguna confirmaci√≥n</span>
          <span *ngIf="(o.partida && !o.destino) || (!o.partida && o.destino)" style="color: orange;">üü° Confirmaci√≥n
            parcial</span>
          <span *ngIf="o.partida && o.destino" style="color: green;">‚úÖ Lista para traspasar</span>
        </td>
        <td>
          <button *ngIf="o.disponibilidad" (click)="cerrar(o.id!)">Cerrar</button>
          <button *ngIf="puedeEditarPuja(oferta)" (click)="abrirPuja(oferta)">Modificar Puja</button>
          <button *ngIf="!o.disponibilidad && !o.partida" (click)="confirmarVenta(o.id!)">Confirmar venta</button>
          <button *ngIf="o.partida && o.destino" (click)="transpaso(o.id!)">Traspaso</button>
          <button (click)="eliminar(o.id!)">Eliminar</button>

        </td>
      </tr>
    </tbody>
  </table>

  <pagination-controls (pageChange)="p = +$event"></pagination-controls>

  <div class="popup" *ngIf="showPopup && rivenSeleccionado" [style.top.px]="popupY + 10" [style.left.px]="popupX + 10">
    <strong>{{ rivenSeleccionado.nombre }}</strong><br>
    {{ rivenSeleccionado.arma }}<br><br>
    <div *ngIf="rivenSeleccionado.stat1">{{ rivenSeleccionado.stat1 }}: {{ rivenSeleccionado.valor1 }}</div>
    <div *ngIf="rivenSeleccionado.stat2">{{ rivenSeleccionado.stat2 }}: {{ rivenSeleccionado.valor2 }}</div>
    <div *ngIf="rivenSeleccionado.stat3">{{ rivenSeleccionado.stat3 }}: {{ rivenSeleccionado.valor3 }}</div>
    <div *ngIf="rivenSeleccionado.stat4">{{ rivenSeleccionado.stat4 }}: {{ rivenSeleccionado.valor4 }}</div>
  </div>

  <div *ngIf="pujaOferta" class="puja-modal">
    <h3>Modificar puja para: {{ pujaOferta.nombreRiven }}</h3>
    <p>Precio actual: {{ pujaOferta.precioVenta }}p</p>

    <label>Nueva puja:</label>
    <input type="number" [(ngModel)]="nuevaPuja" style="width: 100%; margin-bottom: 0.5rem;" />

    <div *ngIf="errorPuja" style="color: red; margin-bottom: 0.5rem;">{{ errorPuja }}</div>

    <button (click)="confirmarPuja()" style="margin-right: 1rem;">Confirmar</button>
    <button (click)="cerrarPuja()">Cancelar</button>
  </div>
</div>